<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <title>详细信息</title>
    <link rel="stylesheet" href="olapi/theme/default/style.css" type="text/css">
    <link rel="stylesheet" href="olapi/style.css" type="text/css">
    <link rel="stylesheet" href="css/style.css" type="text/css">
    <script src="js/jquery-1.11.0.min.js"></script>
    <script src="js/jquery.contextmenu.r2.js"></script>
    <script src="olapi/OpenLayers.js"></script>

    <script src="js/map.js"></script>
    <script>
        function init() {
            /*动态设置map的样式*/
            var width = $(document.body).width();
            var height = $(document.body).height();
            $("#map").css("height",height);
            $("#map").css("width",width);
            $("#map").css("left",0);
            $("#map").css("bottom",0);
            var options = {
                controls: [],
                Units: "degrees",
                tileSize: new OpenLayers.Size(256, 256),
                singleTile: true,
                transitionEffect: "resize",
                projection: "EPSG:4326"
            };
            this.map = new HdMap();
            var url="http://211.101.37.251:6080/arcgis/rest/services/GZGXPTMAP_DY/MapServer/export";
            this.map.init("map", options, url);

            var lines = ['LINESTRING (115.76832333 24.77657667, 115.76819333 24.77665333, 115.76806167 24.776735, 115.76793333 24.77680833, 115.767785 24.77689333, 115.76764167 24.77697167, 115.76745833 24.77707167, 115.76731 24.77715, 115.76714667 24.777235, 115.76696667 24.77733, 115.76677333 24.77742167, 115.76656833 24.77752, 115.766355 24.77762167, 115.76614 24.77772, 115.76591667 24.77781833, 115.76568 24.777915, 115.76543333 24.77800667, 115.76519167 24.7781, 115.76493833 24.77819333, 115.76467 24.77828, 115.76440167 24.77837)'];

            var sketchSymbolizers = {
                "Point": {
                    pointRadius: 4,
                    graphicName: "square",
                    fillColor: "white",
                    fillOpacity: 1,
                    strokeWidth: 1,
                    strokeOpacity: 1,
                    strokeColor: "#333333",
                    externalGraphic: "images/mark.png",
                    graphicWidth: 24,
                    graphicHeight: 24
                },
                "Line": {
                    strokeWidth: 3,
                    strokeOpacity: 1,
                    strokeColor: "#0000FF"
                },
                "Polygon": {
                    strokeWidth: 2,
                    strokeOpacity: 1,
                    strokeColor: "#ffffff",
                    fillColor: "#00008B",
                    fillOpacity: 0.3
                }
            };
            var style = new OpenLayers.Style();

            style.addRules([
                new OpenLayers.Rule({symbolizer: sketchSymbolizers})
            ]);

            var styleMap = new OpenLayers.StyleMap({"default": style});

//            this.map.addLine(lines, styleMap);

            var point = new OpenLayers.Geometry.Point(115.76832333,24.77657667);
            var pointList = [];
            for (var p = 0; p < 6; ++p) {
                var a = p * (2 * Math.PI) / 7;
                var r = Math.random(1) + 1;
                var newPoint = new OpenLayers.Geometry.Point(point.x + 5 + (r * Math.cos(a)),
                        point.y + 5 + (r * Math.sin(a)));
                pointList.push(newPoint);
            }
            pointList.push(pointList[0]);
            var linearRing = new OpenLayers.Geometry.LinearRing(pointList);
            var polygonFeature = new OpenLayers.Feature.Vector(
                    new OpenLayers.Geometry.Polygon([linearRing]));





            this.map.addPolygon(polygonFeature, styleMap);
        }


    </script>
    <style type="text/css">
        html,body{
            height: 100%;
            width: 100%;
            overflow: hidden;
        }
        #map {
            position: absolute;
            /*背景颜色设置为这个能解决背景颜色问题*/
            background-color: #fdfdfd;
        }
    </style>
</head>
<body onload=init();>
<div id="map"></div>
</body>
</html>
